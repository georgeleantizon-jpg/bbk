<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.7">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #000000; -webkit-text-stroke: #4689cc; background-color: #ffffff}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #000000; -webkit-text-stroke: #8cd3fe; background-color: #ffffff}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #000000; -webkit-text-stroke: #c27e65; background-color: #ffffff}
    p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #000000; -webkit-text-stroke: #cacaca; background-color: #ffffff}
    p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #000000; -webkit-text-stroke: #6d7378; background-color: #ffffff}
    p.p6 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #000000; -webkit-text-stroke: #cacaca; background-color: #ffffff; min-height: 16.0px}
    p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #000000; -webkit-text-stroke: #71c083; background-color: #ffffff}
    span.s1 {font-kerning: none}
    span.s2 {font-kerning: none; -webkit-text-stroke: 0px #8cd3fe}
    span.s3 {font-kerning: none; -webkit-text-stroke: 0px #6d6d6d}
    span.s4 {font-kerning: none; -webkit-text-stroke: 0px #cacaca}
    span.s5 {font-kerning: none; -webkit-text-stroke: 0px #c27e65}
    span.s6 {font-kerning: none; -webkit-text-stroke: 0px #4689cc}
    span.s7 {font-kerning: none; -webkit-text-stroke: 0px #d4d4d4}
    span.s8 {font-kerning: none; -webkit-text-stroke: 0px #71c083}
    span.s9 {font-kerning: none; -webkit-text-stroke: 0px #a7c598}
    span.s10 {font-kerning: none; -webkit-text-stroke: 0px #6d7378}
    span.s11 {font-kerning: none; -webkit-text-stroke: 0px #b76ff7}
    span.s12 {font-kerning: none; -webkit-text-stroke: 0px #36c0a0}
    span.s13 {font-kerning: none; -webkit-text-stroke: 0px #f67c30}
    span.s14 {font-kerning: none; -webkit-text-stroke: 0px #a34f83}
  </style>
</head>
<body>
<p class="p1"><span class="s1">&lt;!DOCTYPE</span><span class="s2"> html</span><span class="s1">&gt;</span></p>
<p class="p1"><span class="s3">&lt;</span><span class="s1">html</span><span class="s4"> </span><span class="s2">lang</span><span class="s3">=</span><span class="s5">"en"</span><span class="s3">&gt;</span></p>
<p class="p1"><span class="s3">&lt;</span><span class="s1">head</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">meta</span><span class="s4"> </span><span class="s1">charset</span><span class="s3">=</span><span class="s5">"UTF-8"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">meta</span><span class="s4"> </span><span class="s2">name</span><span class="s3">=</span><span class="s1">"viewport"</span><span class="s4"> </span><span class="s2">content</span><span class="s3">=</span><span class="s1">"width=device-width, initial-scale=1.0"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">title</span><span class="s3">&gt;</span><span class="s1">BuoBuo Ka - Pre-Order System</span><span class="s3">&lt;/</span><span class="s6">title</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;!-- Load Tailwind CSS --&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">script</span><span class="s4"> </span><span class="s2">src</span><span class="s3">=</span><span class="s1">"https://cdn.tailwindcss.com"</span><span class="s3">&gt;&lt;/</span><span class="s6">script</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;!-- Load Inter font --&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">link</span><span class="s4"> </span><span class="s2">href</span><span class="s3">=</span><span class="s1">"https://fonts.googleapis.com/css2?family=Inter:wght@100..900&amp;display=swap"</span><span class="s4"> </span><span class="s2">rel</span><span class="s3">=</span><span class="s1">"stylesheet"</span><span class="s3">&gt;</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s1">style</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">/* Custom styles and font configuration */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">body</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">font-family:</span><span class="s1"> </span><span class="s8">'Inter'</span><span class="s7">,</span><span class="s1"> </span><span class="s5">sans-serif</span><span class="s7">;</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">background-color:</span><span class="s4"> #f7f7f7</span><span class="s7">;</span><span class="s4"> </span><span class="s1">/* Light background */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.container-card</span><span class="s4"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">box-shadow:</span><span class="s1"> </span><span class="s9">0</span><span class="s1"> </span><span class="s9">10px</span><span class="s1"> </span><span class="s9">30px</span><span class="s1"> </span><span class="s5">rgba(</span><span class="s9">0</span><span class="s7">,</span><span class="s1"> </span><span class="s9">0</span><span class="s7">,</span><span class="s1"> </span><span class="s9">0</span><span class="s7">,</span><span class="s1"> </span><span class="s9">0.1</span><span class="s5">)</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.btn-primary</span><span class="s4"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">transition:</span><span class="s1"> </span><span class="s5">all</span><span class="s1"> </span><span class="s9">0.2s</span><span class="s1"> </span><span class="s5">ease-in-out</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">background-color:</span><span class="s1"> #3b82f6</span><span class="s7">;</span><span class="s1"> </span><span class="s10">/* Blue 500 */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">color:</span><span class="s1"> </span><span class="s5">white</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">box-shadow:</span><span class="s1"> </span><span class="s9">0</span><span class="s1"> </span><span class="s9">4px</span><span class="s1"> </span><span class="s9">6px</span><span class="s1"> </span><span class="s5">rgba(</span><span class="s9">59</span><span class="s7">,</span><span class="s1"> </span><span class="s9">130</span><span class="s7">,</span><span class="s1"> </span><span class="s9">246</span><span class="s7">,</span><span class="s1"> </span><span class="s9">0.2</span><span class="s5">)</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.btn-primary:hover</span><span class="s4"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">background-color:</span><span class="s1"> #2563eb</span><span class="s7">;</span><span class="s1"> </span><span class="s10">/* Blue 600 */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">transform:</span><span class="s1"> </span><span class="s5">translateY(</span><span class="s9">-1px</span><span class="s5">)</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.design-card</span><span class="s4"> </span><span class="s7">{</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">transition:</span><span class="s4"> </span><span class="s1">transform</span><span class="s4"> </span><span class="s9">0.2s</span><span class="s4"> </span><span class="s1">ease-in-out</span><span class="s7">,</span><span class="s4"> </span><span class="s1">box-shadow</span><span class="s4"> </span><span class="s9">0.2s</span><span class="s4"> </span><span class="s1">ease-in-out</span><span class="s7">;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">border:</span><span class="s4"> </span><span class="s9">2px</span><span class="s4"> </span><span class="s1">solid</span><span class="s4"> </span><span class="s1">transparent</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.design-card:hover</span><span class="s4"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">transform:</span><span class="s1"> </span><span class="s5">translateY(</span><span class="s9">-3px</span><span class="s5">)</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">box-shadow:</span><span class="s1"> </span><span class="s9">0</span><span class="s1"> </span><span class="s9">6px</span><span class="s1"> </span><span class="s9">15px</span><span class="s1"> </span><span class="s5">rgba(</span><span class="s9">59</span><span class="s7">,</span><span class="s1"> </span><span class="s9">130</span><span class="s7">,</span><span class="s1"> </span><span class="s9">246</span><span class="s7">,</span><span class="s1"> </span><span class="s9">0.3</span><span class="s5">)</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.design-card.selected</span><span class="s4"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">border-color:</span><span class="s1"> #3b82f6</span><span class="s7">;</span><span class="s1"> </span><span class="s10">/* Blue 500 border */</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">box-shadow:</span><span class="s4"> </span><span class="s9">0</span><span class="s4"> </span><span class="s9">0</span><span class="s4"> </span><span class="s9">0</span><span class="s4"> </span><span class="s9">4px</span><span class="s4"> </span><span class="s5">rgba(</span><span class="s9">59</span><span class="s7">,</span><span class="s4"> </span><span class="s9">130</span><span class="s7">,</span><span class="s4"> </span><span class="s9">246</span><span class="s7">,</span><span class="s4"> </span><span class="s9">0.4</span><span class="s5">)</span><span class="s7">;</span><span class="s4"> </span><span class="s1">/* Focus ring effect */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">/* Sticky Order Summary for better UX */</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">#order-summary-sticky</span><span class="s4"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">position:</span><span class="s1"> </span><span class="s5">sticky</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">top:</span><span class="s1"> </span><span class="s9">2rem</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s1">style</span><span class="s3">&gt;</span></p>
<p class="p1"><span class="s3">&lt;/</span><span class="s1">head</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s3">&lt;</span><span class="s6">body</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"min-h-screen p-4 sm:p-8 flex items-start justify-center"</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"app"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"w-full max-w-5xl bg-white rounded-xl container-card p-6 md:p-10 my-8"</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">&lt;!-- Header --&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">header</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-center mb-10"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">h1</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-4xl font-extrabold text-gray-900 tracking-tight"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>BuoBuo Ka Pre-Order</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">h1</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">h2</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-xl font-medium text-blue-600 mt-1"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>A Product by Team A.N.G. A. Co.</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">h2</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">p</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"text-gray-500 mt-2"</span><span class="s3">&gt;</span><span class="s1">Design your world, 2D or 3D.</span><span class="s3">&lt;/</span><span class="s6">p</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;/</span><span class="s6">header</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">&lt;!-- Dynamic Content Area --&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"content-area"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">&lt;!-- Content will be injected here by JavaScript --&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">&lt;!-- Submission Status/Modal --&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"message-box"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-white p-8 rounded-lg shadow-2xl max-w-sm w-full text-center"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">h3</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"message-title"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-2xl font-bold mb-3 text-gray-800"</span><span class="s3">&gt;&lt;/</span><span class="s6">h3</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">p</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"message-text"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-gray-600 mb-6"</span><span class="s3">&gt;&lt;/</span><span class="s6">p</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"message-button"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"btn-primary px-6 py-2 rounded-lg font-semibold"</span><span class="s3">&gt;&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;!-- Firebase SDK --&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">script</span><span class="s4"> </span><span class="s2">type</span><span class="s3">=</span><span class="s1">"module"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// Import Firebase modules</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s11">import</span><span class="s4"> </span><span class="s7">{</span><span class="s4"> initializeApp </span><span class="s7">}</span><span class="s4"> </span><span class="s11">from</span><span class="s4"> </span><span class="s1">"https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js"</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">import</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> getAuth</span><span class="s7">,</span><span class="s1"> signInAnonymously</span><span class="s7">,</span><span class="s1"> signInWithCustomToken</span><span class="s7">,</span><span class="s1"> onAuthStateChanged </span><span class="s7">}</span><span class="s1"> </span><span class="s11">from</span><span class="s1"> </span><span class="s8">"https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js"</span><span class="s7">;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s11">import</span><span class="s4"> </span><span class="s7">{</span><span class="s4"> getFirestore</span><span class="s7">,</span><span class="s4"> collection</span><span class="s7">,</span><span class="s4"> addDoc</span><span class="s7">,</span><span class="s4"> setLogLevel </span><span class="s7">}</span><span class="s4"> </span><span class="s11">from</span><span class="s4"> </span><span class="s1">"https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js"</span><span class="s7">;</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- FIREBASE AND APP CONFIGURATION ---</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">let</span><span class="s1"> db</span><span class="s7">,</span><span class="s1"> auth</span><span class="s7">;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// These global variables are provided by the environment.</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">const</span><span class="s1"> appId </span><span class="s7">=</span><span class="s1"> </span><span class="s11">typeof</span><span class="s1"> __app_id </span><span class="s7">!==</span><span class="s1"> </span><span class="s8">'undefined'</span><span class="s1"> </span><span class="s7">?</span><span class="s1"> __app_id </span><span class="s7">:</span><span class="s1"> </span><span class="s8">'buobuo-ka-orders'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">const</span><span class="s1"> firebaseConfig </span><span class="s7">=</span><span class="s1"> </span><span class="s11">typeof</span><span class="s1"> __firebase_config </span><span class="s7">!==</span><span class="s1"> </span><span class="s8">'undefined'</span><span class="s1"> </span><span class="s7">?</span><span class="s1"> </span><span class="s12">JSON</span><span class="s7">.</span><span class="s1">parse</span><span class="s7">(</span><span class="s1">__firebase_config</span><span class="s7">)</span><span class="s1"> </span><span class="s7">:</span><span class="s1"> </span><span class="s7">{};</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">try</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> app </span><span class="s7">=</span><span class="s1"> initializeApp</span><span class="s7">(</span><span class="s1">firebaseConfig</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>db </span><span class="s7">=</span><span class="s1"> getFirestore</span><span class="s7">(</span><span class="s1">app</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>auth </span><span class="s7">=</span><span class="s1"> getAuth</span><span class="s7">(</span><span class="s1">app</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>setLogLevel</span><span class="s7">(</span><span class="s8">'debug'</span><span class="s7">);</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Sign in the user</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">if</span><span class="s1"> </span><span class="s7">(</span><span class="s11">typeof</span><span class="s1"> __initial_auth_token </span><span class="s7">!==</span><span class="s1"> </span><span class="s8">'undefined'</span><span class="s1"> </span><span class="s7">&amp;&amp;</span><span class="s1"> __initial_auth_token</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">await</span><span class="s1"> signInWithCustomToken</span><span class="s7">(</span><span class="s1">auth</span><span class="s7">,</span><span class="s1"> __initial_auth_token</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span><span class="s1"> </span><span class="s11">else</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">await</span><span class="s1"> signInAnonymously</span><span class="s7">(</span><span class="s1">auth</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span><span class="s1"> </span><span class="s11">catch</span><span class="s1"> </span><span class="s7">(</span><span class="s1">e</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span>console</span><span class="s7">.</span><span class="s4">error</span><span class="s7">(</span><span class="s1">"Firebase initialization failed:"</span><span class="s7">,</span><span class="s4"> e</span><span class="s7">);</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span>showMessage</span><span class="s7">(</span><span class="s1">'Error'</span><span class="s7">,</span><span class="s4"> </span><span class="s1">'Could not connect to the database. Please refresh and try again.'</span><span class="s7">,</span><span class="s4"> </span><span class="s1">'refresh'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- APPLICATION CONSTANTS ---</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">const</span><span class="s1"> </span><span class="s12">APP_CONTAINER</span><span class="s1"> </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'content-area'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">const</span><span class="s1"> </span><span class="s12">MESSAGE_BOX</span><span class="s1"> </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'message-box'</span><span class="s7">);</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">const</span><span class="s1"> </span><span class="s12">BASE_PRICES</span><span class="s1"> </span><span class="s7">=</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">'2D'</span><span class="s7">:</span><span class="s1"> </span><span class="s13">500.00</span><span class="s7">,</span><span class="s1"><span class="Apple-converted-space">  </span></span><span class="s10">// PHP</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">'3D'</span><span class="s7">:</span><span class="s1"> </span><span class="s13">1500.00</span><span class="s1"><span class="Apple-converted-space">  </span></span><span class="s10">// PHP</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">};</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">const</span><span class="s1"> </span><span class="s12">ADD_ONS</span><span class="s1"> </span><span class="s7">=</span><span class="s1"> </span><span class="s7">[</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s7">{</span><span class="s4"> id</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'delivery'</span><span class="s7">,</span><span class="s4"> name</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'Standard Delivery (Flat Rate)'</span><span class="s7">,</span><span class="s4"> price</span><span class="s7">:</span><span class="s4"> </span><span class="s13">150.00</span><span class="s7">,</span><span class="s4"> description</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'Flat rate for delivery within the region.'</span><span class="s4"> </span><span class="s7">},</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s7">{</span><span class="s4"> id</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'custom_card'</span><span class="s7">,</span><span class="s4"> name</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'Customized Message Card'</span><span class="s7">,</span><span class="s4"> price</span><span class="s7">:</span><span class="s4"> </span><span class="s13">50.00</span><span class="s7">,</span><span class="s4"> description</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'A personalized card included with the order.'</span><span class="s4"> </span><span class="s7">},</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s7">{</span><span class="s4"> id</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'ferry_lights'</span><span class="s7">,</span><span class="s4"> name</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'Fairy Lights Only'</span><span class="s7">,</span><span class="s4"> price</span><span class="s7">:</span><span class="s4"> </span><span class="s13">100.00</span><span class="s7">,</span><span class="s4"> description</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'Ambient LED fairy lights (battery not included).'</span><span class="s4"> </span><span class="s7">},</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s7">{</span><span class="s4"> id</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'acrylic_box'</span><span class="s7">,</span><span class="s4"> name</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'Acrylic Display Box Only'</span><span class="s7">,</span><span class="s4"> price</span><span class="s7">:</span><span class="s4"> </span><span class="s13">200.00</span><span class="s7">,</span><span class="s4"> description</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'Premium, clear acrylic display box.'</span><span class="s4"> </span><span class="s7">},</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s7">{</span><span class="s4"> id</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'combo'</span><span class="s7">,</span><span class="s4"> name</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'Fairy Lights &amp; Acrylic Box Combo'</span><span class="s7">,</span><span class="s4"> price</span><span class="s7">:</span><span class="s4"> </span><span class="s13">250.00</span><span class="s7">,</span><span class="s4"> description</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'Both lights and the premium display box together.'</span><span class="s4"> </span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">];</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- IMAGE UPDATE AREA ---</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// Replace the placeholder URLs below with your actual product image URLs.</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">const</span><span class="s1"> </span><span class="s12">PRESETS</span><span class="s1"> </span><span class="s7">=</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">'3D'</span><span class="s7">:</span><span class="s1"> </span><span class="s7">[</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s7">{</span><span class="s4"> id</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'3d-1'</span><span class="s7">,</span><span class="s4"> name</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'Geo-Prism Tower'</span><span class="s7">,</span><span class="s4"> imageUrl</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'https://placehold.co/200x200/3B82F6/FFFFFF/?text=Geo-Prism'</span><span class="s4"> </span><span class="s7">},</span><span class="s4"><span class="Apple-converted-space"> </span></span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s7">{</span><span class="s4"> id</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'3d-2'</span><span class="s7">,</span><span class="s4"> name</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'Woven Vortex'</span><span class="s7">,</span><span class="s4"> imageUrl</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'https://placehold.co/200x200/10B981/FFFFFF/?text=Woven+Vortex'</span><span class="s4"> </span><span class="s7">},</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s7">{</span><span class="s4"> id</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'3d-3'</span><span class="s7">,</span><span class="s4"> name</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'Flora Bloom'</span><span class="s7">,</span><span class="s4"> imageUrl</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'https://placehold.co/200x200/F59E0B/FFFFFF/?text=Flora+Bloom'</span><span class="s4"> </span><span class="s7">},</span><span class="s4"><span class="Apple-converted-space"> </span></span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s7">{</span><span class="s4"> id</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'3d-4'</span><span class="s7">,</span><span class="s4"> name</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'Cyberpunk Grid'</span><span class="s7">,</span><span class="s4"> imageUrl</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'https://placehold.co/200x200/EC4899/FFFFFF/?text=Cyber+Grid'</span><span class="s4"> </span><span class="s7">},</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s7">{</span><span class="s4"> id</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'3d-5'</span><span class="s7">,</span><span class="s4"> name</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'Celestial Sphere'</span><span class="s7">,</span><span class="s4"> imageUrl</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'https://placehold.co/200x200/8B5CF6/FFFFFF/?text=Celestial'</span><span class="s4"> </span><span class="s7">},</span><span class="s4"><span class="Apple-converted-space"> </span></span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s7">{</span><span class="s4"> id</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'3d-6'</span><span class="s7">,</span><span class="s4"> name</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'Retro Robot'</span><span class="s7">,</span><span class="s4"> imageUrl</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'https://placehold.co/200x200/6366F1/FFFFFF/?text=Robot'</span><span class="s4"> </span><span class="s7">},</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s7">{</span><span class="s4"> id</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'3d-7'</span><span class="s7">,</span><span class="s4"> name</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'Abstract Flow'</span><span class="s7">,</span><span class="s4"> imageUrl</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'https://placehold.co/200x200/D97706/FFFFFF/?text=Abstract'</span><span class="s4"> </span><span class="s7">},</span><span class="s4"><span class="Apple-converted-space"> </span></span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s7">{</span><span class="s4"> id</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'3d-8'</span><span class="s7">,</span><span class="s4"> name</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'Mountain Peak'</span><span class="s7">,</span><span class="s4"> imageUrl</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'https://placehold.co/200x200/059669/FFFFFF/?text=Mountain'</span><span class="s4"> </span><span class="s7">},</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s7">{</span><span class="s4"> id</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'3d-9'</span><span class="s7">,</span><span class="s4"> name</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'Spiral Stair'</span><span class="s7">,</span><span class="s4"> imageUrl</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'https://placehold.co/200x200/9333EA/FFFFFF/?text=Spiral'</span><span class="s4"> </span><span class="s7">},</span><span class="s4"><span class="Apple-converted-space"> </span></span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s7">{</span><span class="s4"> id</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'3d-10'</span><span class="s7">,</span><span class="s4"> name</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'Pixel Cube'</span><span class="s7">,</span><span class="s4"> imageUrl</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'https://placehold.co/200x200/4F46E5/FFFFFF/?text=Pixel+Cube'</span><span class="s4"> </span><span class="s7">},</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">],</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">'2D'</span><span class="s7">:</span><span class="s1"> </span><span class="s7">[</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s7">{</span><span class="s4"> id</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'2d-A'</span><span class="s7">,</span><span class="s4"> name</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'Geometric Pattern'</span><span class="s7">,</span><span class="s4"> imageUrl</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'https://placehold.co/200x200/EF4444/FFFFFF/?text=Geometric'</span><span class="s4"> </span><span class="s7">},</span><span class="s4"><span class="Apple-converted-space"> </span></span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s7">{</span><span class="s4"> id</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'2d-B'</span><span class="s7">,</span><span class="s4"> name</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'Minimalist Line Art'</span><span class="s7">,</span><span class="s4"> imageUrl</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'https://placehold.co/200x200/6B7280/FFFFFF/?text=Line+Art'</span><span class="s4"> </span><span class="s7">},</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s7">{</span><span class="s4"> id</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'2d-C'</span><span class="s7">,</span><span class="s4"> name</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'Pop Art Portrait'</span><span class="s7">,</span><span class="s4"> imageUrl</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'https://placehold.co/200x200/EAB308/FFFFFF/?text=Pop+Art'</span><span class="s4"> </span><span class="s7">},</span><span class="s4"><span class="Apple-converted-space"> </span></span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s7">{</span><span class="s4"> id</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'2d-D'</span><span class="s7">,</span><span class="s4"> name</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'Watercolor Splatter'</span><span class="s7">,</span><span class="s4"> imageUrl</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'https://placehold.co/200x200/22C55E/FFFFFF/?text=Watercolor'</span><span class="s4"> </span><span class="s7">},</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s7">{</span><span class="s4"> id</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'2d-E'</span><span class="s7">,</span><span class="s4"> name</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'Vintage Poster Style'</span><span class="s7">,</span><span class="s4"> imageUrl</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'https://placehold.co/200x200/84CC16/FFFFFF/?text=Vintage'</span><span class="s4"> </span><span class="s7">},</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">]</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">};</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- APPLICATION STATE ---</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">let</span><span class="s1"> currentStep </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'mode_selection'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">let</span><span class="s1"> orderData </span><span class="s7">=</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>items</span><span class="s7">:</span><span class="s1"> </span><span class="s7">[],</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>addOns</span><span class="s7">:</span><span class="s1"> </span><span class="s7">{},</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>name</span><span class="s7">:</span><span class="s1"> </span><span class="s8">''</span><span class="s7">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>email</span><span class="s7">:</span><span class="s1"> </span><span class="s8">''</span><span class="s7">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>phone</span><span class="s7">:</span><span class="s1"> </span><span class="s8">''</span><span class="s7">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>address</span><span class="s7">:</span><span class="s1"> </span><span class="s8">''</span><span class="s7">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>calculations</span><span class="s7">:</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> subtotal</span><span class="s7">:</span><span class="s1"> </span><span class="s13">0</span><span class="s7">,</span><span class="s1"> discount</span><span class="s7">:</span><span class="s1"> </span><span class="s13">0</span><span class="s7">,</span><span class="s1"> addOnTotal</span><span class="s7">:</span><span class="s1"> </span><span class="s13">0</span><span class="s7">,</span><span class="s1"> finalTotal</span><span class="s7">:</span><span class="s1"> </span><span class="s13">0</span><span class="s1"> </span><span class="s7">},</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>timestamp</span><span class="s7">:</span><span class="s1"> </span><span class="s11">new</span><span class="s1"> </span><span class="s12">Date</span><span class="s7">().</span><span class="s1">toISOString</span><span class="s7">()</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">};</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- CORE FUNCTIONS ---</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">function</span><span class="s1"> calculateOrder</span><span class="s7">()</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">let</span><span class="s1"> subtotal </span><span class="s7">=</span><span class="s1"> </span><span class="s13">0</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">let</span><span class="s1"> productCount </span><span class="s7">=</span><span class="s1"> </span><span class="s13">0</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">let</span><span class="s1"> highestProductPrice </span><span class="s7">=</span><span class="s1"> </span><span class="s13">0</span><span class="s7">;</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>orderData</span><span class="s7">.</span><span class="s1">items</span><span class="s7">.</span><span class="s1">forEach</span><span class="s7">(</span><span class="s1">item </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">const</span><span class="s1"> itemPrice </span><span class="s7">=</span><span class="s1"> item</span><span class="s7">.</span><span class="s1">price </span><span class="s7">*</span><span class="s1"> item</span><span class="s7">.</span><span class="s1">quantity</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>subtotal </span><span class="s7">+=</span><span class="s1"> itemPrice</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>productCount </span><span class="s7">+=</span><span class="s1"> item</span><span class="s7">.</span><span class="s1">quantity</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">item</span><span class="s7">.</span><span class="s1">price </span><span class="s7">&gt;</span><span class="s1"> highestProductPrice</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>highestProductPrice </span><span class="s7">=</span><span class="s1"> item</span><span class="s7">.</span><span class="s1">price</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">});</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">let</span><span class="s1"> discount </span><span class="s7">=</span><span class="s1"> </span><span class="s13">0</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">productCount </span><span class="s7">&gt;=</span><span class="s1"> </span><span class="s13">3</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>discount </span><span class="s7">=</span><span class="s1"> highestProductPrice </span><span class="s7">*</span><span class="s1"> </span><span class="s13">0.10</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">let</span><span class="s1"> addOnTotal </span><span class="s7">=</span><span class="s1"> </span><span class="s13">0</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">Object</span><span class="s7">.</span><span class="s1">keys</span><span class="s7">(</span><span class="s1">orderData</span><span class="s7">.</span><span class="s1">addOns</span><span class="s7">).</span><span class="s1">forEach</span><span class="s7">(</span><span class="s1">id </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">const</span><span class="s1"> addon </span><span class="s7">=</span><span class="s1"> </span><span class="s12">ADD_ONS</span><span class="s7">.</span><span class="s1">find</span><span class="s7">(</span><span class="s1">a </span><span class="s7">=&gt;</span><span class="s1"> a</span><span class="s7">.</span><span class="s1">id </span><span class="s7">===</span><span class="s1"> id</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">addon</span><span class="s7">)</span><span class="s1"> addOnTotal </span><span class="s7">+=</span><span class="s1"> addon</span><span class="s7">.</span><span class="s1">price</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">});</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> finalTotal </span><span class="s7">=</span><span class="s1"> subtotal </span><span class="s7">-</span><span class="s1"> discount </span><span class="s7">+</span><span class="s1"> addOnTotal</span><span class="s7">;</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>orderData</span><span class="s7">.</span><span class="s1">calculations </span><span class="s7">=</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>subtotal</span><span class="s7">:</span><span class="s1"> parseFloat</span><span class="s7">(</span><span class="s1">subtotal</span><span class="s7">.</span><span class="s1">toFixed</span><span class="s7">(</span><span class="s13">2</span><span class="s7">)),</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>discount</span><span class="s7">:</span><span class="s1"> parseFloat</span><span class="s7">(</span><span class="s1">discount</span><span class="s7">.</span><span class="s1">toFixed</span><span class="s7">(</span><span class="s13">2</span><span class="s7">)),</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>addOnTotal</span><span class="s7">:</span><span class="s1"> parseFloat</span><span class="s7">(</span><span class="s1">addOnTotal</span><span class="s7">.</span><span class="s1">toFixed</span><span class="s7">(</span><span class="s13">2</span><span class="s7">)),</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>finalTotal</span><span class="s7">:</span><span class="s1"> parseFloat</span><span class="s7">(</span><span class="s1">finalTotal</span><span class="s7">.</span><span class="s1">toFixed</span><span class="s7">(</span><span class="s13">2</span><span class="s7">))</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">};</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>updateSummaryDisplay</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">function</span><span class="s1"> updateSummaryDisplay</span><span class="s7">()</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> summaryDiv </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'order-summary-container'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">if</span><span class="s1"> </span><span class="s7">(!</span><span class="s1">summaryDiv</span><span class="s7">)</span><span class="s1"> </span><span class="s11">return</span><span class="s7">;</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> productCount </span><span class="s7">=</span><span class="s1"> orderData</span><span class="s7">.</span><span class="s1">items</span><span class="s7">.</span><span class="s1">reduce</span><span class="s7">((</span><span class="s1">sum</span><span class="s7">,</span><span class="s1"> item</span><span class="s7">)</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> sum </span><span class="s7">+</span><span class="s1"> item</span><span class="s7">.</span><span class="s1">quantity</span><span class="s7">,</span><span class="s1"> </span><span class="s13">0</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> discountApplies </span><span class="s7">=</span><span class="s1"> orderData</span><span class="s7">.</span><span class="s1">calculations</span><span class="s7">.</span><span class="s1">discount </span><span class="s7">&gt;</span><span class="s1"> </span><span class="s13">0</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> discountText </span><span class="s7">=</span><span class="s1"> discountApplies </span><span class="s7">?</span><span class="s1"> </span><span class="s8">`&lt;span class="text-green-600 font-semibold"&gt;-₱</span><span class="s7">${</span><span class="s1">orderData</span><span class="s7">.</span><span class="s1">calculations</span><span class="s7">.</span><span class="s1">discount</span><span class="s7">.</span><span class="s1">toLocaleString</span><span class="s7">(</span><span class="s8">'en-US'</span><span class="s7">,</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> minimumFractionDigits</span><span class="s7">:</span><span class="s1"> </span><span class="s13">2</span><span class="s7">,</span><span class="s1"> maximumFractionDigits</span><span class="s7">:</span><span class="s1"> </span><span class="s13">2</span><span class="s1"> </span><span class="s7">})}</span><span class="s8"> (Faction Promo)&lt;/span&gt;`</span><span class="s1"> </span><span class="s7">:</span><span class="s1"> </span><span class="s8">`&lt;span class="text-gray-500"&gt;None&lt;/span&gt;`</span><span class="s7">;</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s11">let</span><span class="s4"> itemsList </span><span class="s7">=</span><span class="s4"> orderData</span><span class="s7">.</span><span class="s4">items</span><span class="s7">.</span><span class="s4">length </span><span class="s7">===</span><span class="s4"> </span><span class="s13">0</span><span class="s4"> </span><span class="s7">?</span><span class="s4"> </span><span class="s1">'&lt;p class="text-gray-500"&gt;No products added yet.&lt;/p&gt;'</span><span class="s4"> </span><span class="s7">:</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>orderData</span><span class="s7">.</span><span class="s1">items</span><span class="s7">.</span><span class="s1">map</span><span class="s7">((</span><span class="s1">item</span><span class="s7">,</span><span class="s1"> index</span><span class="s7">)</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s8">`</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div class="flex justify-between items-center text-sm border-b border-gray-100 py-1 last:border-b-0"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div class="flex-grow truncate pr-2"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                             </span>&lt;span class="font-bold text-gray-800"&gt;</span><span class="s7">${</span><span class="s4">item</span><span class="s7">.</span><span class="s4">quantity</span><span class="s7">}</span><span class="s1">x </span><span class="s7">${</span><span class="s4">item</span><span class="s7">.</span><span class="s4">dimension</span><span class="s7">}</span><span class="s1"> </span><span class="s7">${</span><span class="s4">item</span><span class="s7">.</span><span class="s4">type</span><span class="s7">}</span><span class="s1">&lt;/span&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                             </span>&lt;p class="text-xs text-gray-500 truncate"&gt;</span><span class="s7">${</span><span class="s4">item</span><span class="s7">.</span><span class="s4">name</span><span class="s7">}</span><span class="s1">&lt;/p&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div class="flex-shrink-0 flex items-center space-x-2"&gt;</span></p>
<p class="p4"><span class="s8"><span class="Apple-converted-space">                            </span>&lt;span class="font-medium text-gray-700"&gt;₱</span><span class="s7">${(</span><span class="s1">item</span><span class="s7">.</span><span class="s1">price </span><span class="s7">*</span><span class="s1"> item</span><span class="s7">.</span><span class="s1">quantity</span><span class="s7">).</span><span class="s1">toLocaleString</span><span class="s7">(</span><span class="s8">'en-US'</span><span class="s7">,</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> minimumFractionDigits</span><span class="s7">:</span><span class="s1"> </span><span class="s13">2</span><span class="s7">,</span><span class="s1"> maximumFractionDigits</span><span class="s7">:</span><span class="s1"> </span><span class="s13">2</span><span class="s1"> </span><span class="s7">})}</span><span class="s8">&lt;/span&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;button onclick="window.app.removeItem(</span><span class="s7">${</span><span class="s4">index</span><span class="s7">}</span><span class="s1">)" class="text-red-400 hover:text-red-600 text-lg p-1 transition-colors" title="Remove Item"&gt;&amp;times;&lt;/button&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span>`</span><span class="s7">).</span><span class="s4">join</span><span class="s7">(</span><span class="s1">''</span><span class="s7">);</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s11">let</span><span class="s4"> addOnsList </span><span class="s7">=</span><span class="s4"> </span><span class="s12">Object</span><span class="s7">.</span><span class="s4">keys</span><span class="s7">(</span><span class="s4">orderData</span><span class="s7">.</span><span class="s4">addOns</span><span class="s7">).</span><span class="s4">length </span><span class="s7">===</span><span class="s4"> </span><span class="s13">0</span><span class="s4"> </span><span class="s7">?</span><span class="s4"> </span><span class="s1">'&lt;p class="text-gray-500 text-xs"&gt;No add-ons selected.&lt;/p&gt;'</span><span class="s4"> </span><span class="s7">:</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">ADD_ONS</span><span class="s7">.</span><span class="s1">filter</span><span class="s7">(</span><span class="s1">addon </span><span class="s7">=&gt;</span><span class="s1"> orderData</span><span class="s7">.</span><span class="s1">addOns</span><span class="s7">[</span><span class="s1">addon</span><span class="s7">.</span><span class="s1">id</span><span class="s7">]).</span><span class="s1">map</span><span class="s7">(</span><span class="s1">addon </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s8">`</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div class="flex justify-between text-xs text-gray-600"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;span class="ml-2"&gt;</span><span class="s7">${</span><span class="s4">addon</span><span class="s7">.</span><span class="s4">name</span><span class="s7">}</span><span class="s1">&lt;/span&gt;</span></p>
<p class="p4"><span class="s8"><span class="Apple-converted-space">                        </span>&lt;span&gt;₱</span><span class="s7">${</span><span class="s1">addon</span><span class="s7">.</span><span class="s1">price</span><span class="s7">.</span><span class="s1">toLocaleString</span><span class="s7">(</span><span class="s8">'en-US'</span><span class="s7">,</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> minimumFractionDigits</span><span class="s7">:</span><span class="s1"> </span><span class="s13">2</span><span class="s7">,</span><span class="s1"> maximumFractionDigits</span><span class="s7">:</span><span class="s1"> </span><span class="s13">2</span><span class="s1"> </span><span class="s7">})}</span><span class="s8">&lt;/span&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span>`</span><span class="s7">).</span><span class="s4">join</span><span class="s7">(</span><span class="s1">''</span><span class="s7">);</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>summaryDiv</span><span class="s7">.</span><span class="s1">innerHTML </span><span class="s7">=</span><span class="s1"> </span><span class="s8">`</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div id="order-summary-sticky" class="p-4 bg-gray-50 rounded-xl shadow-lg border border-gray-100"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;h4 class="text-lg font-bold mb-3 text-blue-700 border-b border-blue-200 pb-2"&gt;🛒 Current Order Summary&lt;/h4&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div class="mb-3 space-y-2"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;p class="font-semibold text-sm mb-1 text-gray-700"&gt;Products (</span><span class="s7">${</span><span class="s4">productCount</span><span class="s7">}</span><span class="s1"> Total):&lt;/p&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div class="pl-0 space-y-1"&gt;</span><span class="s7">${</span><span class="s4">itemsList</span><span class="s7">}</span><span class="s1">&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div class="mb-4 border-t pt-3 border-gray-200"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                         </span>&lt;p class="font-semibold text-sm mb-1 text-gray-700"&gt;Add-Ons:&lt;/p&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                         </span>&lt;div class="pl-2 space-y-1"&gt;</span><span class="s7">${</span><span class="s4">addOnsList</span><span class="s7">}</span><span class="s1">&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div class="text-sm font-medium space-y-1 border-t pt-3 border-gray-200"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div class="flex justify-between"&gt;&lt;span&gt;Subtotal (Products):&lt;/span&gt; &lt;span&gt;₱</span><span class="s7">${</span><span class="s4">orderData</span><span class="s7">.</span><span class="s4">calculations</span><span class="s7">.</span><span class="s4">subtotal</span><span class="s7">.</span><span class="s4">toLocaleString</span><span class="s7">(</span><span class="s1">'en-US'</span><span class="s7">,</span><span class="s4"> </span><span class="s7">{</span><span class="s4"> minimumFractionDigits</span><span class="s7">:</span><span class="s4"> </span><span class="s13">2</span><span class="s7">,</span><span class="s4"> maximumFractionDigits</span><span class="s7">:</span><span class="s4"> </span><span class="s13">2</span><span class="s4"> </span><span class="s7">})}</span><span class="s1">&lt;/span&gt;&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div class="flex justify-between"&gt;&lt;span&gt;Add-ons Total:&lt;/span&gt; &lt;span&gt;₱</span><span class="s7">${</span><span class="s4">orderData</span><span class="s7">.</span><span class="s4">calculations</span><span class="s7">.</span><span class="s4">addOnTotal</span><span class="s7">.</span><span class="s4">toLocaleString</span><span class="s7">(</span><span class="s1">'en-US'</span><span class="s7">,</span><span class="s4"> </span><span class="s7">{</span><span class="s4"> minimumFractionDigits</span><span class="s7">:</span><span class="s4"> </span><span class="s13">2</span><span class="s7">,</span><span class="s4"> maximumFractionDigits</span><span class="s7">:</span><span class="s4"> </span><span class="s13">2</span><span class="s4"> </span><span class="s7">})}</span><span class="s1">&lt;/span&gt;&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div class="flex justify-between"&gt;&lt;span&gt;Discount:&lt;/span&gt; </span><span class="s7">${</span><span class="s4">discountText</span><span class="s7">}</span><span class="s1">&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div class="flex justify-between text-xl font-extrabold mt-3 pt-3 border-t-2 border-blue-500"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;span&gt;Total:&lt;/span&gt;</span></p>
<p class="p4"><span class="s8"><span class="Apple-converted-space">                        </span>&lt;span&gt;₱</span><span class="s7">${</span><span class="s1">orderData</span><span class="s7">.</span><span class="s1">calculations</span><span class="s7">.</span><span class="s1">finalTotal</span><span class="s7">.</span><span class="s1">toLocaleString</span><span class="s7">(</span><span class="s8">'en-US'</span><span class="s7">,</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> minimumFractionDigits</span><span class="s7">:</span><span class="s1"> </span><span class="s13">2</span><span class="s7">,</span><span class="s1"> maximumFractionDigits</span><span class="s7">:</span><span class="s1"> </span><span class="s13">2</span><span class="s1"> </span><span class="s7">})}</span><span class="s8">&lt;/span&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">${</span><span class="s4">productCount </span><span class="s7">&gt;=</span><span class="s4"> </span><span class="s13">3</span><span class="s4"> </span><span class="s7">?</span><span class="s4"> </span><span class="s1">`&lt;p class="text-center text-xs mt-2 text-green-700 bg-green-100 p-1 rounded-md"&gt;✅ Faction Promo Applied!&lt;/p&gt;`</span><span class="s4"> </span><span class="s7">:</span><span class="s4"> </span><span class="s1">''</span><span class="s7">}</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span>`</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>updateNextButtonState</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">function</span><span class="s1"> removeItem</span><span class="s7">(</span><span class="s1">index</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">currentStep </span><span class="s7">!==</span><span class="s1"> </span><span class="s8">'mode_selection'</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s11">return</span><span class="s4"> showMessage</span><span class="s7">(</span><span class="s1">'Cannot Edit'</span><span class="s7">,</span><span class="s4"> </span><span class="s1">'Please return to Step 1: Build Your Order to make changes.'</span><span class="s7">,</span><span class="s4"> </span><span class="s1">'continue'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>orderData</span><span class="s7">.</span><span class="s1">items</span><span class="s7">.</span><span class="s1">splice</span><span class="s7">(</span><span class="s1">index</span><span class="s7">,</span><span class="s1"> </span><span class="s13">1</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>calculateOrder</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">function</span><span class="s1"> clearSelectionAreaPrompt</span><span class="s7">()</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> selectionArea </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'selection-area'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">selectionArea</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>selectionArea</span><span class="s7">.</span><span class="s4">innerHTML </span><span class="s7">=</span><span class="s4"> </span><span class="s1">'&lt;p class="text-center text-gray-500 pt-10"&gt;Select an option above to add more items, or proceed to add-ons when ready.&lt;/p&gt;'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- STEP RENDERING FUNCTIONS ---</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">function</span><span class="s1"> renderModeSelection</span><span class="s7">()</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>calculateOrder</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">APP_CONTAINER</span><span class="s7">.</span><span class="s1">innerHTML </span><span class="s7">=</span><span class="s1"> </span><span class="s8">`</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div class="grid grid-cols-1 lg:grid-cols-3 gap-6"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div class="lg:col-span-2"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;h3 class="text-2xl font-semibold mb-8 text-gray-800"&gt;Step 1: Build Your Order&lt;/h3&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div class="flex flex-col sm:flex-row gap-4 mb-8"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;button onclick="window.app.selectMode('preset', '3D')" class="p-6 bg-yellow-50 border-2 border-yellow-200 rounded-xl hover:bg-yellow-100 transition-all shadow-md flex-1 min-w-[150px]"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;p class="text-3xl mb-1"&gt;🧊&lt;/p&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;p class="text-xl font-bold text-gray-800"&gt;3D Pre-set&lt;/p&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;p class="text-sm text-gray-500"&gt;₱</span><span class="s7">${</span><span class="s12">BASE_PRICES</span><span class="s7">[</span><span class="s1">'3D'</span><span class="s7">].</span><span class="s4">toLocaleString</span><span class="s7">(</span><span class="s1">'en-US'</span><span class="s7">,</span><span class="s4"> </span><span class="s7">{</span><span class="s4"> minimumFractionDigits</span><span class="s7">:</span><span class="s4"> </span><span class="s13">2</span><span class="s7">,</span><span class="s4"> maximumFractionDigits</span><span class="s7">:</span><span class="s4"> </span><span class="s13">2</span><span class="s4"> </span><span class="s7">})}</span><span class="s1">&lt;/p&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;/button&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;button onclick="window.app.selectMode('preset', '2D')" class="p-6 bg-red-50 border-2 border-red-200 rounded-xl hover:bg-red-100 transition-all shadow-md flex-1 min-w-[150px]"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;p class="text-3xl mb-1"&gt;🖼️&lt;/p&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;p class="text-xl font-bold text-gray-800"&gt;2D Pre-set&lt;/p&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;p class="text-sm text-gray-500"&gt;₱</span><span class="s7">${</span><span class="s12">BASE_PRICES</span><span class="s7">[</span><span class="s1">'2D'</span><span class="s7">].</span><span class="s4">toLocaleString</span><span class="s7">(</span><span class="s1">'en-US'</span><span class="s7">,</span><span class="s4"> </span><span class="s7">{</span><span class="s4"> minimumFractionDigits</span><span class="s7">:</span><span class="s4"> </span><span class="s13">2</span><span class="s7">,</span><span class="s4"> maximumFractionDigits</span><span class="s7">:</span><span class="s4"> </span><span class="s13">2</span><span class="s4"> </span><span class="s7">})}</span><span class="s1">&lt;/p&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;/button&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;button onclick="window.app.selectMode('custom', '3D')" class="p-6 bg-purple-50 border-2 border-purple-200 rounded-xl hover:bg-purple-100 transition-all shadow-md flex-1 min-w-[150px]"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;p class="text-3xl mb-1"&gt;✨&lt;/p&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;p class="text-xl font-bold text-gray-800"&gt;Custom Order&lt;/p&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;p class="text-sm text-gray-500"&gt;Choose 2D/3D&lt;/p&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;/button&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div id="selection-area"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;p class="text-center text-gray-500 pt-10"&gt;Select an option above to begin configuring your item.&lt;/p&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div class="lg:col-span-1"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div id="order-summary-container"&gt;&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;button id="next-to-addons" onclick="window.app.selectStep('addons')" class="mt-6 btn-primary px-6 py-3 rounded-lg font-semibold w-full text-lg disabled:opacity-50" disabled&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>Proceed to Add-ons →</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/button&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span>`</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>currentStep </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'mode_selection'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>updateSummaryDisplay</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">function</span><span class="s1"> renderPresetSelection</span><span class="s7">(</span><span class="s1">dimension</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> designs </span><span class="s7">=</span><span class="s1"> </span><span class="s12">PRESETS</span><span class="s7">[</span><span class="s1">dimension</span><span class="s7">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> selectionArea </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'selection-area'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> price </span><span class="s7">=</span><span class="s1"> </span><span class="s12">BASE_PRICES</span><span class="s7">[</span><span class="s1">dimension</span><span class="s7">];</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>selectionArea</span><span class="s7">.</span><span class="s1">innerHTML </span><span class="s7">=</span><span class="s1"> </span><span class="s8">`</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div class="bg-gray-100 p-6 rounded-lg"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;h4 class="text-xl font-bold mb-4 text-gray-800"&gt;</span><span class="s7">${</span><span class="s4">dimension</span><span class="s7">}</span><span class="s1"> Pre-set Designs (₱</span><span class="s7">${</span><span class="s4">price</span><span class="s7">.</span><span class="s4">toLocaleString</span><span class="s7">(</span><span class="s1">'en-US'</span><span class="s7">,</span><span class="s4"> </span><span class="s7">{</span><span class="s4"> minimumFractionDigits</span><span class="s7">:</span><span class="s4"> </span><span class="s13">2</span><span class="s7">,</span><span class="s4"> maximumFractionDigits</span><span class="s7">:</span><span class="s4"> </span><span class="s13">2</span><span class="s4"> </span><span class="s7">})}</span><span class="s1">)&lt;/h4&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;input type="hidden" id="selected-design-id"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4 mb-6"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s7">${</span><span class="s4">designs</span><span class="s7">.</span><span class="s4">map</span><span class="s7">(</span><span class="s4">design </span><span class="s7">=&gt;</span><span class="s4"> </span><span class="s1">`</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;div id="design-</span><span class="s7">${</span><span class="s4">design</span><span class="s7">.</span><span class="s4">id</span><span class="s7">}</span><span class="s1">" onclick="window.app.selectDesign('</span><span class="s7">${</span><span class="s4">design</span><span class="s7">.</span><span class="s4">id</span><span class="s7">}</span><span class="s1">', '</span><span class="s7">${</span><span class="s4">dimension</span><span class="s7">}</span><span class="s1">')"</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>class="design-card cursor-pointer p-2 rounded-lg bg-white shadow-sm text-center transform hover:shadow-lg flex flex-col justify-between"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;!-- IMAGE: Replaced the emoji with an &lt;img&gt; tag --&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;img src="</span><span class="s7">${</span><span class="s4">design</span><span class="s7">.</span><span class="s4">imageUrl</span><span class="s7">}</span><span class="s1">" alt="</span><span class="s7">${</span><span class="s4">design</span><span class="s7">.</span><span class="s4">name</span><span class="s7">}</span><span class="s1">" class="w-full h-24 object-cover rounded-md mb-2"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                    </span>&lt;p class="text-xs font-semibold text-gray-700"&gt;</span><span class="s7">${</span><span class="s4">design</span><span class="s7">.</span><span class="s4">name</span><span class="s7">}</span><span class="s1">&lt;/p&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                    </span>&lt;p class="text-xxs text-gray-400"&gt;ID: </span><span class="s7">${</span><span class="s4">design</span><span class="s7">.</span><span class="s4">id</span><span class="s7">}</span><span class="s1">&lt;/p&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>`</span><span class="s7">).</span><span class="s4">join</span><span class="s7">(</span><span class="s1">''</span><span class="s7">)}</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div class="flex items-end space-x-4"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div class="flex-grow"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;label for="quantity-input" class="block text-sm font-medium text-gray-700"&gt;Quantity&lt;/label&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;input type="number" id="quantity-input" value="1" min="1" onchange="window.app.validateQuantity(this)"</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border focus:ring-blue-500 focus:border-blue-500 sm:text-sm"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;button id="add-to-order-btn" onclick="window.app.addToOrder('preset')" class="btn-primary px-4 py-2.5 rounded-lg font-semibold disabled:opacity-50" disabled&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>Add to Order</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/button&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span>`</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> tempId </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'selected-design-id'</span><span class="s7">).</span><span class="s1">value</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">tempId</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">const</span><span class="s1"> designCard </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">`design-</span><span class="s7">${</span><span class="s1">tempId</span><span class="s7">}</span><span class="s8">`</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">designCard</span><span class="s7">)</span><span class="s1"> designCard</span><span class="s7">.</span><span class="s1">classList</span><span class="s7">.</span><span class="s1">add</span><span class="s7">(</span><span class="s8">'selected'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'add-to-order-btn'</span><span class="s7">).</span><span class="s1">disabled </span><span class="s7">=</span><span class="s1"> </span><span class="s11">false</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">function</span><span class="s1"> renderCustomization</span><span class="s7">()</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> selectionArea </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'selection-area'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>selectionArea</span><span class="s7">.</span><span class="s1">innerHTML </span><span class="s7">=</span><span class="s1"> </span><span class="s8">`</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div class="bg-gray-100 p-6 rounded-lg"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;h4 class="text-xl font-bold mb-4 text-gray-800"&gt;Custom Order&lt;/h4&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div class="mb-4"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;p class="font-semibold text-gray-700 mb-2"&gt;Choose Final Output Dimension:&lt;/p&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div class="flex gap-4"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;label class="flex items-center p-3 bg-white border border-gray-300 rounded-lg cursor-pointer flex-1 hover:bg-gray-50 transition-colors"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;input type="radio" name="customDimension" value="3D" price="</span><span class="s7">${</span><span class="s12">BASE_PRICES</span><span class="s7">[</span><span class="s1">'3D'</span><span class="s7">]}</span><span class="s1">" class="form-radio text-blue-600 h-4 w-4" onchange="window.app.updateCustomization(this)"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;span class="ml-2 text-gray-700 font-medium"&gt;3D Model (₱</span><span class="s7">${</span><span class="s12">BASE_PRICES</span><span class="s7">[</span><span class="s1">'3D'</span><span class="s7">].</span><span class="s4">toLocaleString</span><span class="s7">(</span><span class="s1">'en-US'</span><span class="s7">,</span><span class="s4"> </span><span class="s7">{</span><span class="s4"> minimumFractionDigits</span><span class="s7">:</span><span class="s4"> </span><span class="s13">2</span><span class="s7">,</span><span class="s4"> maximumFractionDigits</span><span class="s7">:</span><span class="s4"> </span><span class="s13">2</span><span class="s4"> </span><span class="s7">})}</span><span class="s1">)&lt;/span&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;/label&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;label class="flex items-center p-3 bg-white border border-gray-300 rounded-lg cursor-pointer flex-1 hover:bg-gray-50 transition-colors"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;input type="radio" name="customDimension" value="2D" price="</span><span class="s7">${</span><span class="s12">BASE_PRICES</span><span class="s7">[</span><span class="s1">'2D'</span><span class="s7">]}</span><span class="s1">" class="form-radio text-blue-600 h-4 w-4" onchange="window.app.updateCustomization(this)"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;span class="ml-2 text-gray-700 font-medium"&gt;2D Print/Art (₱</span><span class="s7">${</span><span class="s12">BASE_PRICES</span><span class="s7">[</span><span class="s1">'2D'</span><span class="s7">].</span><span class="s4">toLocaleString</span><span class="s7">(</span><span class="s1">'en-US'</span><span class="s7">,</span><span class="s4"> </span><span class="s7">{</span><span class="s4"> minimumFractionDigits</span><span class="s7">:</span><span class="s4"> </span><span class="s13">2</span><span class="s7">,</span><span class="s4"> maximumFractionDigits</span><span class="s7">:</span><span class="s4"> </span><span class="s13">2</span><span class="s4"> </span><span class="s7">})}</span><span class="s1">)&lt;/span&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;/label&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div class="bg-yellow-50 p-4 rounded-lg border-l-4 border-yellow-400 mb-4"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;p class="font-bold text-yellow-800 mb-1"&gt;Custom Upload Guidelines (Mandatory):&lt;/p&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;ul class="list-disc list-inside text-sm text-yellow-700 space-y-1"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                           </span>&lt;li&gt;*Note: Only the file name will be recorded for follow-up; the file itself is NOT uploaded.*&lt;/li&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/ul&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div class="mb-4"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;label for="customPhoto" class="block font-medium text-gray-700 mb-1"&gt;Upload Reference Photo&lt;/label&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;input type="file" id="customPhoto" accept="image/png, image/jpeg"</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                               </span>onchange="window.app.handleCustomFileUpload(this.files)"</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                               </span>class="w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-purple-50 file:text-purple-700 hover:file:bg-purple-100"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;p id="file-status" class="mt-2 text-sm text-gray-500"&gt;No file selected.&lt;/p&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div class="flex items-end space-x-4"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div class="flex-grow"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;label for="quantity-input-custom" class="block text-sm font-medium text-gray-700"&gt;Quantity&lt;/label&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;input type="number" id="quantity-input-custom" value="1" min="1" onchange="window.app.validateQuantity(this)"</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border focus:ring-blue-500 focus:border-blue-500 sm:text-sm"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;button id="add-to-order-btn-custom" onclick="window.app.addToOrder('custom')" class="btn-primary px-4 py-2.5 rounded-lg font-semibold disabled:opacity-50" disabled&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>Add to Order</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/button&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span>`</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">function</span><span class="s1"> renderAddOnsSelection</span><span class="s7">()</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> productCount </span><span class="s7">=</span><span class="s1"> orderData</span><span class="s7">.</span><span class="s1">items</span><span class="s7">.</span><span class="s1">reduce</span><span class="s7">((</span><span class="s1">sum</span><span class="s7">,</span><span class="s1"> item</span><span class="s7">)</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> sum </span><span class="s7">+</span><span class="s1"> item</span><span class="s7">.</span><span class="s1">quantity</span><span class="s7">,</span><span class="s1"> </span><span class="s13">0</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">APP_CONTAINER</span><span class="s7">.</span><span class="s1">innerHTML </span><span class="s7">=</span><span class="s1"> </span><span class="s8">`</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div class="grid grid-cols-1 lg:grid-cols-3 gap-6"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div class="lg:col-span-2"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;h3 class="text-2xl font-semibold mb-8 text-gray-800"&gt;Step 2: Add-ons and Faction Promo&lt;/h3&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div class="bg-green-50 p-4 rounded-lg border-l-4 border-green-400 mb-6"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;p class="font-bold text-green-800 mb-1"&gt;💰 Faction Promo:&lt;/p&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;p class="text-sm text-green-700"&gt;If you buy &lt;strong&gt;three or more&lt;/strong&gt; BuoBuo Ka products (total quantity), you automatically get &lt;strong&gt;10% off the highest costing product&lt;/strong&gt; in your order!&lt;/p&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;p class="text-sm mt-1 text-green-900 font-semibold"&gt;Current Products in Order: </span><span class="s7">${</span><span class="s4">productCount</span><span class="s7">}</span><span class="s1">&lt;/p&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div class="space-y-4"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;p class="text-lg font-semibold text-gray-700"&gt;Choose Optional Add-ons:&lt;/p&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s7">${</span><span class="s12">ADD_ONS</span><span class="s7">.</span><span class="s4">map</span><span class="s7">(</span><span class="s4">addon </span><span class="s7">=&gt;</span><span class="s4"> </span><span class="s1">`</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;label for="</span><span class="s7">${</span><span class="s4">addon</span><span class="s7">.</span><span class="s4">id</span><span class="s7">}</span><span class="s1">" class="flex items-center justify-between p-4 bg-white border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                    </span>&lt;div class="flex items-center"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                        </span>&lt;input type="checkbox" id="</span><span class="s7">${</span><span class="s4">addon</span><span class="s7">.</span><span class="s4">id</span><span class="s7">}</span><span class="s1">" data-price="</span><span class="s7">${</span><span class="s4">addon</span><span class="s7">.</span><span class="s4">price</span><span class="s7">}</span><span class="s1">" onchange="window.app.updateAddOns('</span><span class="s7">${</span><span class="s4">addon</span><span class="s7">.</span><span class="s4">id</span><span class="s7">}</span><span class="s1">', this.checked)"</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                            </span>class="form-checkbox h-5 w-5 text-blue-600 rounded focus:ring-blue-500"</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                            </span></span><span class="s7">${</span><span class="s4">orderData</span><span class="s7">.</span><span class="s4">addOns</span><span class="s7">[</span><span class="s4">addon</span><span class="s7">.</span><span class="s4">id</span><span class="s7">]</span><span class="s4"> </span><span class="s7">?</span><span class="s4"> </span><span class="s1">'checked'</span><span class="s4"> </span><span class="s7">:</span><span class="s4"> </span><span class="s1">''</span><span class="s7">}</span><span class="s1">&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                        </span>&lt;div class="ml-4"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                            </span>&lt;span class="text-base font-medium text-gray-800"&gt;</span><span class="s7">${</span><span class="s4">addon</span><span class="s7">.</span><span class="s4">name</span><span class="s7">}</span><span class="s1">&lt;/span&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                            </span>&lt;p class="text-xs text-gray-500"&gt;</span><span class="s7">${</span><span class="s4">addon</span><span class="s7">.</span><span class="s4">description</span><span class="s7">}</span><span class="s1">&lt;/p&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                        </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                    </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                    </span>&lt;span class="text-base font-bold text-gray-700"&gt;₱</span><span class="s7">${</span><span class="s4">addon</span><span class="s7">.</span><span class="s4">price</span><span class="s7">.</span><span class="s4">toLocaleString</span><span class="s7">(</span><span class="s1">'en-US'</span><span class="s7">,</span><span class="s4"> </span><span class="s7">{</span><span class="s4"> minimumFractionDigits</span><span class="s7">:</span><span class="s4"> </span><span class="s13">2</span><span class="s7">,</span><span class="s4"> maximumFractionDigits</span><span class="s7">:</span><span class="s4"> </span><span class="s13">2</span><span class="s4"> </span><span class="s7">})}</span><span class="s1">&lt;/span&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;/label&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>`</span><span class="s7">).</span><span class="s4">join</span><span class="s7">(</span><span class="s1">''</span><span class="s7">)}</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;button onclick="window.app.goBack()" class="mt-8 text-gray-500 hover:text-gray-800 transition-colors"&gt;← Back to Product Selection&lt;/button&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div class="lg:col-span-1"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div id="order-summary-container"&gt;&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;button id="next-to-details" onclick="window.app.selectStep('details')" class="mt-6 btn-primary px-6 py-3 rounded-lg font-semibold w-full text-lg"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>Proceed to Details →</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/button&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span>`</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>currentStep </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'addons'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>calculateOrder</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">function</span><span class="s1"> renderDetailsForm</span><span class="s7">()</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">APP_CONTAINER</span><span class="s7">.</span><span class="s1">innerHTML </span><span class="s7">=</span><span class="s1"> </span><span class="s8">`</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span>&lt;h3 class="text-2xl font-semibold text-center mb-8 text-gray-800"&gt;Step 3: Secure Your Pre-Order Details&lt;/h3&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span>&lt;form id="details-form" class="max-w-xl mx-auto space-y-4"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;label for="name" class="block text-sm font-medium text-gray-700"&gt;Full Name&lt;/label&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;input type="text" id="name" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-3 border focus:ring-blue-500 focus:border-blue-500 sm:text-sm" value="</span><span class="s7">${</span><span class="s4">orderData</span><span class="s7">.</span><span class="s4">name</span><span class="s7">}</span><span class="s1">"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;label for="email" class="block text-sm font-medium text-gray-700"&gt;Email Address&lt;/label&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;input type="email" id="email" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-3 border focus:ring-blue-500 focus:border-blue-500 sm:text-sm" value="</span><span class="s7">${</span><span class="s4">orderData</span><span class="s7">.</span><span class="s4">email</span><span class="s7">}</span><span class="s1">"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;label for="phone" class="block text-sm font-medium text-gray-700"&gt;Phone Number&lt;/label&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;input type="tel" id="phone" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-3 border focus:ring-blue-500 focus:border-blue-500 sm:text-sm" value="</span><span class="s7">${</span><span class="s4">orderData</span><span class="s7">.</span><span class="s4">phone</span><span class="s7">}</span><span class="s1">"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;label for="address" class="block text-sm font-medium text-gray-700"&gt;Shipping Address&lt;/label&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;textarea id="address" rows="3" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-3 border focus:ring-blue-500 focus:border-blue-500 sm:text-sm"&gt;</span><span class="s7">${</span><span class="s4">orderData</span><span class="s7">.</span><span class="s4">address</span><span class="s7">}</span><span class="s1">&lt;/textarea&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;button type="submit" class="mt-6 btn-primary px-6 py-3 rounded-lg font-semibold w-full"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>Review and Finalize Order</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/button&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/form&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span>&lt;button onclick="window.app.goBack()" class="mt-4 text-gray-500 hover:text-gray-800 transition-colors block text-center mx-auto"&gt;← Back to Add-ons&lt;/button&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span>`</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>currentStep </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'details'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'details-form'</span><span class="s7">).</span><span class="s1">addEventListener</span><span class="s7">(</span><span class="s8">'submit'</span><span class="s7">,</span><span class="s1"> handleDetailsSubmit</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">function</span><span class="s1"> renderConfirmation</span><span class="s7">()</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>calculateOrder</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> productCount </span><span class="s7">=</span><span class="s1"> orderData</span><span class="s7">.</span><span class="s1">items</span><span class="s7">.</span><span class="s1">reduce</span><span class="s7">((</span><span class="s1">sum</span><span class="s7">,</span><span class="s1"> item</span><span class="s7">)</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> sum </span><span class="s7">+</span><span class="s1"> item</span><span class="s7">.</span><span class="s1">quantity</span><span class="s7">,</span><span class="s1"> </span><span class="s13">0</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">APP_CONTAINER</span><span class="s7">.</span><span class="s1">innerHTML </span><span class="s7">=</span><span class="s1"> </span><span class="s8">`</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span>&lt;h3 class="text-2xl font-semibold text-center mb-8 text-gray-800"&gt;Step 4: Confirm Your BuoBuo Ka Pre-Order&lt;/h3&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span>&lt;div class="max-w-3xl mx-auto"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div class="bg-blue-50 p-6 rounded-xl space-y-4 mb-8 border border-blue-200"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;p class="text-lg font-bold text-blue-800 border-b pb-2 border-blue-200"&gt;Order Summary:&lt;/p&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div class="space-y-2"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;p class="font-bold text-gray-700"&gt;Products (</span><span class="s7">${</span><span class="s4">productCount</span><span class="s7">}</span><span class="s1"> items):&lt;/p&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;ul class="pl-4 space-y-1 text-sm text-gray-700"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s7">${</span><span class="s4">orderData</span><span class="s7">.</span><span class="s4">items</span><span class="s7">.</span><span class="s4">map</span><span class="s7">(</span><span class="s4">item </span><span class="s7">=&gt;</span><span class="s4"> </span><span class="s1">`</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                    </span>&lt;li class="flex justify-between"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                        </span>&lt;span&gt;</span><span class="s7">${</span><span class="s4">item</span><span class="s7">.</span><span class="s4">quantity</span><span class="s7">}</span><span class="s1">x </span><span class="s7">${</span><span class="s4">item</span><span class="s7">.</span><span class="s4">name</span><span class="s7">}</span><span class="s1"> (</span><span class="s7">${</span><span class="s4">item</span><span class="s7">.</span><span class="s4">dimension</span><span class="s7">}</span><span class="s1"> </span><span class="s7">${</span><span class="s4">item</span><span class="s7">.</span><span class="s4">type</span><span class="s7">}</span><span class="s1">)&lt;/span&gt;</span></p>
<p class="p4"><span class="s8"><span class="Apple-converted-space">                                        </span>&lt;span&gt;₱</span><span class="s7">${(</span><span class="s1">item</span><span class="s7">.</span><span class="s1">price </span><span class="s7">*</span><span class="s1"> item</span><span class="s7">.</span><span class="s1">quantity</span><span class="s7">).</span><span class="s1">toLocaleString</span><span class="s7">(</span><span class="s8">'en-US'</span><span class="s7">,</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> minimumFractionDigits</span><span class="s7">:</span><span class="s1"> </span><span class="s13">2</span><span class="s7">,</span><span class="s1"> maximumFractionDigits</span><span class="s7">:</span><span class="s1"> </span><span class="s13">2</span><span class="s1"> </span><span class="s7">})}</span><span class="s8">&lt;/span&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                    </span>&lt;/li&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>`</span><span class="s7">).</span><span class="s4">join</span><span class="s7">(</span><span class="s1">''</span><span class="s7">)}</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;/ul&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</span></p>
<p class="p4"><span class="s8"><span class="Apple-converted-space">                        </span></span><span class="s7">${</span><span class="s12">Object</span><span class="s7">.</span><span class="s1">keys</span><span class="s7">(</span><span class="s1">orderData</span><span class="s7">.</span><span class="s1">addOns</span><span class="s7">).</span><span class="s1">length </span><span class="s7">&gt;</span><span class="s1"> </span><span class="s13">0</span><span class="s1"> </span><span class="s7">?</span><span class="s1"> </span><span class="s8">`</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;div class="space-y-2 pt-4 border-t border-blue-200"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;p class="font-bold text-gray-700"&gt;Add-ons:&lt;/p&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;ul class="pl-4 space-y-1 text-sm text-gray-700"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                    </span></span><span class="s7">${</span><span class="s12">ADD_ONS</span><span class="s7">.</span><span class="s4">filter</span><span class="s7">(</span><span class="s4">a </span><span class="s7">=&gt;</span><span class="s4"> orderData</span><span class="s7">.</span><span class="s4">addOns</span><span class="s7">[</span><span class="s4">a</span><span class="s7">.</span><span class="s4">id</span><span class="s7">]).</span><span class="s4">map</span><span class="s7">(</span><span class="s4">a </span><span class="s7">=&gt;</span><span class="s4"> </span><span class="s1">`</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                        </span>&lt;li class="flex justify-between"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                            </span>&lt;span&gt;</span><span class="s7">${</span><span class="s4">a</span><span class="s7">.</span><span class="s4">name</span><span class="s7">}</span><span class="s1">&lt;/span&gt;</span></p>
<p class="p4"><span class="s8"><span class="Apple-converted-space">                                            </span>&lt;span&gt;₱</span><span class="s7">${</span><span class="s1">a</span><span class="s7">.</span><span class="s1">price</span><span class="s7">.</span><span class="s1">toLocaleString</span><span class="s7">(</span><span class="s8">'en-US'</span><span class="s7">,</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> minimumFractionDigits</span><span class="s7">:</span><span class="s1"> </span><span class="s13">2</span><span class="s7">,</span><span class="s1"> maximumFractionDigits</span><span class="s7">:</span><span class="s1"> </span><span class="s13">2</span><span class="s1"> </span><span class="s7">})}</span><span class="s8">&lt;/span&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                        </span>&lt;/li&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                    </span>`</span><span class="s7">).</span><span class="s4">join</span><span class="s7">(</span><span class="s1">''</span><span class="s7">)}</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;/ul&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>`</span><span class="s4"> </span><span class="s7">:</span><span class="s4"> </span><span class="s1">''</span><span class="s7">}</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div class="pt-4 border-t border-blue-200 space-y-2 text-base"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                             </span>&lt;div class="flex justify-between font-medium text-gray-700"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                 </span>&lt;span&gt;Subtotal:&lt;/span&gt;</span></p>
<p class="p4"><span class="s8"><span class="Apple-converted-space">                                 </span>&lt;span&gt;₱</span><span class="s7">${</span><span class="s1">orderData</span><span class="s7">.</span><span class="s1">calculations</span><span class="s7">.</span><span class="s1">subtotal</span><span class="s7">.</span><span class="s1">toLocaleString</span><span class="s7">(</span><span class="s8">'en-US'</span><span class="s7">,</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> minimumFractionDigits</span><span class="s7">:</span><span class="s1"> </span><span class="s13">2</span><span class="s7">,</span><span class="s1"> maximumFractionDigits</span><span class="s7">:</span><span class="s1"> </span><span class="s13">2</span><span class="s1"> </span><span class="s7">})}</span><span class="s8">&lt;/span&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                             </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                             </span>&lt;div class="flex justify-between font-medium text-gray-700"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                 </span>&lt;span&gt;Add-ons Total:&lt;/span&gt;</span></p>
<p class="p4"><span class="s8"><span class="Apple-converted-space">                                 </span>&lt;span&gt;₱</span><span class="s7">${</span><span class="s1">orderData</span><span class="s7">.</span><span class="s1">calculations</span><span class="s7">.</span><span class="s1">addOnTotal</span><span class="s7">.</span><span class="s1">toLocaleString</span><span class="s7">(</span><span class="s8">'en-US'</span><span class="s7">,</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> minimumFractionDigits</span><span class="s7">:</span><span class="s1"> </span><span class="s13">2</span><span class="s7">,</span><span class="s1"> maximumFractionDigits</span><span class="s7">:</span><span class="s1"> </span><span class="s13">2</span><span class="s1"> </span><span class="s7">})}</span><span class="s8">&lt;/span&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                             </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                             </span>&lt;div class="flex justify-between font-medium text-green-600"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                 </span>&lt;span&gt;Discount:&lt;/span&gt;</span></p>
<p class="p4"><span class="s8"><span class="Apple-converted-space">                                 </span>&lt;span&gt;-₱</span><span class="s7">${</span><span class="s1">orderData</span><span class="s7">.</span><span class="s1">calculations</span><span class="s7">.</span><span class="s1">discount</span><span class="s7">.</span><span class="s1">toLocaleString</span><span class="s7">(</span><span class="s8">'en-US'</span><span class="s7">,</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> minimumFractionDigits</span><span class="s7">:</span><span class="s1"> </span><span class="s13">2</span><span class="s7">,</span><span class="s1"> maximumFractionDigits</span><span class="s7">:</span><span class="s1"> </span><span class="s13">2</span><span class="s1"> </span><span class="s7">})}</span><span class="s8">&lt;/span&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                             </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                             </span>&lt;div class="flex justify-between text-2xl font-extrabold mt-4 pt-4 border-t-2 border-blue-500 text-gray-900"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                                 </span>&lt;span&gt;Final Total:&lt;/span&gt;</span></p>
<p class="p4"><span class="s8"><span class="Apple-converted-space">                                 </span>&lt;span&gt;₱</span><span class="s7">${</span><span class="s1">orderData</span><span class="s7">.</span><span class="s1">calculations</span><span class="s7">.</span><span class="s1">finalTotal</span><span class="s7">.</span><span class="s1">toLocaleString</span><span class="s7">(</span><span class="s8">'en-US'</span><span class="s7">,</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> minimumFractionDigits</span><span class="s7">:</span><span class="s1"> </span><span class="s13">2</span><span class="s7">,</span><span class="s1"> maximumFractionDigits</span><span class="s7">:</span><span class="s1"> </span><span class="s13">2</span><span class="s1"> </span><span class="s7">})}</span><span class="s8">&lt;/span&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                             </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div class="bg-gray-50 p-6 rounded-xl border border-gray-200"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                         </span>&lt;p class="text-lg font-bold text-gray-800 border-b pb-2 border-gray-200"&gt;Shipping Details:&lt;/p&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                         </span>&lt;div class="text-gray-700 space-y-2 mt-2"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                             </span>&lt;p&gt;&lt;strong&gt;Name:&lt;/strong&gt; </span><span class="s7">${</span><span class="s4">orderData</span><span class="s7">.</span><span class="s4">name</span><span class="s7">}</span><span class="s1">&lt;/p&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                             </span>&lt;p&gt;&lt;strong&gt;Email:&lt;/strong&gt; </span><span class="s7">${</span><span class="s4">orderData</span><span class="s7">.</span><span class="s4">email</span><span class="s7">}</span><span class="s1">&lt;/p&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                             </span>&lt;p&gt;&lt;strong&gt;Phone:&lt;/strong&gt; </span><span class="s7">${</span><span class="s4">orderData</span><span class="s7">.</span><span class="s4">phone</span><span class="s7">}</span><span class="s1">&lt;/p&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                             </span>&lt;p&gt;&lt;strong&gt;Address:&lt;/strong&gt; </span><span class="s7">${</span><span class="s4">orderData</span><span class="s7">.</span><span class="s4">address</span><span class="s7">.</span><span class="s4">replace</span><span class="s7">(</span><span class="s14">/\n/</span><span class="s11">g</span><span class="s7">,</span><span class="s4"> </span><span class="s1">'&lt;br&gt;'</span><span class="s7">)}</span><span class="s1">&lt;/p&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                         </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div class="mt-8 flex flex-col sm:flex-row gap-4"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;button onclick="window.app.goBack()" class="btn-secondary px-6 py-3 rounded-lg font-semibold w-full bg-gray-200 text-gray-800 hover:bg-gray-300 transition-colors"&gt;← Make Changes&lt;/button&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;button id="final-submit-btn" onclick="window.app.handleFinalSubmit()" class="btn-primary px-6 py-3 rounded-lg font-semibold w-full text-lg"&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                            </span>Confirm &amp; Submit Pre-Order</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/button&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</span></p>
<p class="p7"><span class="s1"><span class="Apple-converted-space">            </span>`</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>currentStep </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'confirmation'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- EVENT HANDLERS &amp; NAVIGATION ---</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">function</span><span class="s1"> selectMode</span><span class="s7">(</span><span class="s1">type</span><span class="s7">,</span><span class="s1"> dimension</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">type </span><span class="s7">===</span><span class="s1"> </span><span class="s8">'preset'</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>renderPresetSelection</span><span class="s7">(</span><span class="s1">dimension</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span><span class="s1"> </span><span class="s11">else</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>renderCustomization</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">function</span><span class="s1"> selectDesign</span><span class="s7">(</span><span class="s1">designId</span><span class="s7">,</span><span class="s1"> dimension</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>document</span><span class="s7">.</span><span class="s1">querySelectorAll</span><span class="s7">(</span><span class="s8">'.design-card'</span><span class="s7">).</span><span class="s1">forEach</span><span class="s7">(</span><span class="s1">card </span><span class="s7">=&gt;</span><span class="s1"> card</span><span class="s7">.</span><span class="s1">classList</span><span class="s7">.</span><span class="s1">remove</span><span class="s7">(</span><span class="s8">'selected'</span><span class="s7">));</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">`design-</span><span class="s7">${</span><span class="s1">designId</span><span class="s7">}</span><span class="s8">`</span><span class="s7">).</span><span class="s1">classList</span><span class="s7">.</span><span class="s1">add</span><span class="s7">(</span><span class="s8">'selected'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'selected-design-id'</span><span class="s7">).</span><span class="s1">value </span><span class="s7">=</span><span class="s1"> designId</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'add-to-order-btn'</span><span class="s7">).</span><span class="s1">disabled </span><span class="s7">=</span><span class="s1"> </span><span class="s11">false</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">function</span><span class="s1"> validateQuantity</span><span class="s7">(</span><span class="s1">input</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">parseInt</span><span class="s7">(</span><span class="s1">input</span><span class="s7">.</span><span class="s1">value</span><span class="s7">)</span><span class="s1"> </span><span class="s7">&lt;</span><span class="s1"> </span><span class="s13">1</span><span class="s1"> </span><span class="s7">||</span><span class="s1"> </span><span class="s7">!</span><span class="s1">input</span><span class="s7">.</span><span class="s1">value</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>input</span><span class="s7">.</span><span class="s1">value </span><span class="s7">=</span><span class="s1"> </span><span class="s13">1</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">function</span><span class="s1"> addToOrder</span><span class="s7">(</span><span class="s1">type</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">let</span><span class="s1"> newItem </span><span class="s7">=</span><span class="s1"> </span><span class="s7">{};</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">type </span><span class="s7">===</span><span class="s1"> </span><span class="s8">'preset'</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">const</span><span class="s1"> designId </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'selected-design-id'</span><span class="s7">).</span><span class="s1">value</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">const</span><span class="s1"> dimension </span><span class="s7">=</span><span class="s1"> </span><span class="s12">PRESETS</span><span class="s7">[</span><span class="s8">'3D'</span><span class="s7">].</span><span class="s1">some</span><span class="s7">(</span><span class="s1">d </span><span class="s7">=&gt;</span><span class="s1"> d</span><span class="s7">.</span><span class="s1">id </span><span class="s7">===</span><span class="s1"> designId</span><span class="s7">)</span><span class="s1"> </span><span class="s7">?</span><span class="s1"> </span><span class="s8">'3D'</span><span class="s1"> </span><span class="s7">:</span><span class="s1"> </span><span class="s8">'2D'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">const</span><span class="s1"> design </span><span class="s7">=</span><span class="s1"> </span><span class="s12">PRESETS</span><span class="s7">[</span><span class="s1">dimension</span><span class="s7">].</span><span class="s1">find</span><span class="s7">(</span><span class="s1">d </span><span class="s7">=&gt;</span><span class="s1"> d</span><span class="s7">.</span><span class="s1">id </span><span class="s7">===</span><span class="s1"> designId</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">const</span><span class="s1"> quantity </span><span class="s7">=</span><span class="s1"> parseInt</span><span class="s7">(</span><span class="s1">document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'quantity-input'</span><span class="s7">).</span><span class="s1">value</span><span class="s7">)</span><span class="s1"> </span><span class="s7">||</span><span class="s1"> </span><span class="s13">1</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>newItem </span><span class="s7">=</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>type</span><span class="s7">:</span><span class="s1"> </span><span class="s8">'Preset'</span><span class="s7">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>dimension</span><span class="s7">:</span><span class="s1"> dimension</span><span class="s7">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>name</span><span class="s7">:</span><span class="s1"> design</span><span class="s7">.</span><span class="s1">name</span><span class="s7">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>price</span><span class="s7">:</span><span class="s1"> </span><span class="s12">BASE_PRICES</span><span class="s7">[</span><span class="s1">dimension</span><span class="s7">],</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>quantity</span><span class="s7">:</span><span class="s1"> quantity</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">};</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span><span class="s1"> </span><span class="s11">else</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> </span><span class="s10">// custom</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">const</span><span class="s1"> dimensionRadio </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">querySelector</span><span class="s7">(</span><span class="s8">'input[name="customDimension"]:checked'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">const</span><span class="s1"> fileInput </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'customPhoto'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">if</span><span class="s1"> </span><span class="s7">(!</span><span class="s1">dimensionRadio </span><span class="s7">||</span><span class="s1"> </span><span class="s7">!</span><span class="s1">fileInput</span><span class="s7">.</span><span class="s1">files</span><span class="s7">[</span><span class="s13">0</span><span class="s7">])</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                     </span></span><span class="s11">return</span><span class="s4"> showMessage</span><span class="s7">(</span><span class="s1">'Missing Info'</span><span class="s7">,</span><span class="s4"> </span><span class="s1">'Please select a dimension and upload a reference file for your custom order.'</span><span class="s7">,</span><span class="s4"> </span><span class="s1">'continue'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">const</span><span class="s1"> dimension </span><span class="s7">=</span><span class="s1"> dimensionRadio</span><span class="s7">.</span><span class="s1">value</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">const</span><span class="s1"> quantity </span><span class="s7">=</span><span class="s1"> parseInt</span><span class="s7">(</span><span class="s1">document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'quantity-input-custom'</span><span class="s7">).</span><span class="s1">value</span><span class="s7">)</span><span class="s1"> </span><span class="s7">||</span><span class="s1"> </span><span class="s13">1</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>newItem </span><span class="s7">=</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>type</span><span class="s7">:</span><span class="s1"> </span><span class="s8">'Custom'</span><span class="s7">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>dimension</span><span class="s7">:</span><span class="s1"> dimension</span><span class="s7">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>name</span><span class="s7">:</span><span class="s1"> </span><span class="s8">`Custom Ref: </span><span class="s7">${</span><span class="s1">fileInput</span><span class="s7">.</span><span class="s1">files</span><span class="s7">[</span><span class="s13">0</span><span class="s7">].</span><span class="s1">name</span><span class="s7">}</span><span class="s8">`</span><span class="s7">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>price</span><span class="s7">:</span><span class="s1"> </span><span class="s12">BASE_PRICES</span><span class="s7">[</span><span class="s1">dimension</span><span class="s7">],</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>quantity</span><span class="s7">:</span><span class="s1"> quantity</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">};</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>orderData</span><span class="s7">.</span><span class="s1">items</span><span class="s7">.</span><span class="s1">push</span><span class="s7">(</span><span class="s1">newItem</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>calculateOrder</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>clearSelectionAreaPrompt</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">function</span><span class="s1"> updateCustomization</span><span class="s7">(</span><span class="s1">radio</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">             </span></span><span class="s11">const</span><span class="s1"> addButton </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'add-to-order-btn-custom'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">             </span></span><span class="s11">const</span><span class="s1"> fileInput </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'customPhoto'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">             </span>addButton</span><span class="s7">.</span><span class="s1">disabled </span><span class="s7">=</span><span class="s1"> </span><span class="s7">!(</span><span class="s1">radio </span><span class="s7">&amp;&amp;</span><span class="s1"> fileInput</span><span class="s7">.</span><span class="s1">files</span><span class="s7">.</span><span class="s1">length </span><span class="s7">&gt;</span><span class="s1"> </span><span class="s13">0</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">function</span><span class="s1"> handleCustomFileUpload</span><span class="s7">(</span><span class="s1">files</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> fileStatus </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'file-status'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> addButton </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'add-to-order-btn-custom'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> dimensionRadio </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">querySelector</span><span class="s7">(</span><span class="s8">'input[name="customDimension"]:checked'</span><span class="s7">);</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">files</span><span class="s7">.</span><span class="s1">length </span><span class="s7">&gt;</span><span class="s1"> </span><span class="s13">0</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>fileStatus</span><span class="s7">.</span><span class="s1">textContent </span><span class="s7">=</span><span class="s1"> </span><span class="s8">`File selected: </span><span class="s7">${</span><span class="s1">files</span><span class="s7">[</span><span class="s13">0</span><span class="s7">].</span><span class="s1">name</span><span class="s7">}</span><span class="s8">`</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>fileStatus</span><span class="s7">.</span><span class="s1">classList</span><span class="s7">.</span><span class="s1">remove</span><span class="s7">(</span><span class="s8">'text-gray-500'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>fileStatus</span><span class="s7">.</span><span class="s1">classList</span><span class="s7">.</span><span class="s1">add</span><span class="s7">(</span><span class="s8">'text-green-600'</span><span class="s7">,</span><span class="s1"> </span><span class="s8">'font-semibold'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>addButton</span><span class="s7">.</span><span class="s1">disabled </span><span class="s7">=</span><span class="s1"> </span><span class="s7">!</span><span class="s1">dimensionRadio</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span><span class="s1"> </span><span class="s11">else</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>fileStatus</span><span class="s7">.</span><span class="s1">textContent </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'No file selected.'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>fileStatus</span><span class="s7">.</span><span class="s1">classList</span><span class="s7">.</span><span class="s1">add</span><span class="s7">(</span><span class="s8">'text-gray-500'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>fileStatus</span><span class="s7">.</span><span class="s1">classList</span><span class="s7">.</span><span class="s1">remove</span><span class="s7">(</span><span class="s8">'text-green-600'</span><span class="s7">,</span><span class="s1"> </span><span class="s8">'font-semibold'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>addButton</span><span class="s7">.</span><span class="s1">disabled </span><span class="s7">=</span><span class="s1"> </span><span class="s11">true</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">function</span><span class="s1"> updateAddOns</span><span class="s7">(</span><span class="s1">id</span><span class="s7">,</span><span class="s1"> isChecked</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> addon </span><span class="s7">=</span><span class="s1"> </span><span class="s12">ADD_ONS</span><span class="s7">.</span><span class="s1">find</span><span class="s7">(</span><span class="s1">a </span><span class="s7">=&gt;</span><span class="s1"> a</span><span class="s7">.</span><span class="s1">id </span><span class="s7">===</span><span class="s1"> id</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">isChecked</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>orderData</span><span class="s7">.</span><span class="s1">addOns</span><span class="s7">[</span><span class="s1">id</span><span class="s7">]</span><span class="s1"> </span><span class="s7">=</span><span class="s1"> addon</span><span class="s7">.</span><span class="s1">price</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span><span class="s1"> </span><span class="s11">else</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">delete</span><span class="s1"> orderData</span><span class="s7">.</span><span class="s1">addOns</span><span class="s7">[</span><span class="s1">id</span><span class="s7">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>calculateOrder</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">function</span><span class="s1"> selectStep</span><span class="s7">(</span><span class="s1">step</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">step </span><span class="s7">===</span><span class="s1"> </span><span class="s8">'addons'</span><span class="s1"> </span><span class="s7">&amp;&amp;</span><span class="s1"> orderData</span><span class="s7">.</span><span class="s1">items</span><span class="s7">.</span><span class="s1">length </span><span class="s7">===</span><span class="s1"> </span><span class="s13">0</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                 </span></span><span class="s11">return</span><span class="s4"> showMessage</span><span class="s7">(</span><span class="s1">'Empty Order'</span><span class="s7">,</span><span class="s4"> </span><span class="s1">'You must add at least one product to your order before proceeding.'</span><span class="s7">,</span><span class="s4"> </span><span class="s1">'continue'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> stepRenderers </span><span class="s7">=</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">'mode_selection'</span><span class="s7">:</span><span class="s1"> renderModeSelection</span><span class="s7">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">'addons'</span><span class="s7">:</span><span class="s1"> renderAddOnsSelection</span><span class="s7">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">'details'</span><span class="s7">:</span><span class="s1"> renderDetailsForm</span><span class="s7">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">'confirmation'</span><span class="s7">:</span><span class="s1"> renderConfirmation</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">};</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>stepRenderers</span><span class="s7">[</span><span class="s1">step</span><span class="s7">]();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">function</span><span class="s1"> goBack</span><span class="s7">()</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> stepMap </span><span class="s7">=</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">'addons'</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'mode_selection'</span><span class="s7">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">'details'</span><span class="s7">:</span><span class="s1"> </span><span class="s8">'addons'</span><span class="s7">,</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">'confirmation'</span><span class="s7">:</span><span class="s4"> </span><span class="s1">'details'</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">};</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> prevStep </span><span class="s7">=</span><span class="s1"> stepMap</span><span class="s7">[</span><span class="s1">currentStep</span><span class="s7">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">prevStep</span><span class="s7">)</span><span class="s1"> selectStep</span><span class="s7">(</span><span class="s1">prevStep</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">function</span><span class="s1"> updateNextButtonState</span><span class="s7">()</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> nextButton </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'next-to-addons'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">nextButton</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>nextButton</span><span class="s7">.</span><span class="s1">disabled </span><span class="s7">=</span><span class="s1"> orderData</span><span class="s7">.</span><span class="s1">items</span><span class="s7">.</span><span class="s1">length </span><span class="s7">===</span><span class="s1"> </span><span class="s13">0</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">function</span><span class="s1"> handleDetailsSubmit</span><span class="s7">(</span><span class="s1">e</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>e</span><span class="s7">.</span><span class="s1">preventDefault</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>orderData</span><span class="s7">.</span><span class="s1">name </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'name'</span><span class="s7">).</span><span class="s1">value</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>orderData</span><span class="s7">.</span><span class="s1">email </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'email'</span><span class="s7">).</span><span class="s1">value</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>orderData</span><span class="s7">.</span><span class="s1">phone </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'phone'</span><span class="s7">).</span><span class="s1">value</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>orderData</span><span class="s7">.</span><span class="s1">address </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'address'</span><span class="s7">).</span><span class="s1">value</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>selectStep</span><span class="s7">(</span><span class="s8">'confirmation'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">async</span><span class="s1"> </span><span class="s11">function</span><span class="s1"> handleFinalSubmit</span><span class="s7">()</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> submitBtn </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'final-submit-btn'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>submitBtn</span><span class="s7">.</span><span class="s1">disabled </span><span class="s7">=</span><span class="s1"> </span><span class="s11">true</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>submitBtn</span><span class="s7">.</span><span class="s1">textContent </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'Submitting...'</span><span class="s7">;</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Update timestamp to final submission time</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>orderData</span><span class="s7">.</span><span class="s1">timestamp </span><span class="s7">=</span><span class="s1"> </span><span class="s11">new</span><span class="s1"> </span><span class="s12">Date</span><span class="s7">().</span><span class="s1">toISOString</span><span class="s7">();</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">try</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s11">if</span><span class="s4"> </span><span class="s7">(!</span><span class="s4">db</span><span class="s7">)</span><span class="s4"> </span><span class="s11">throw</span><span class="s4"> </span><span class="s11">new</span><span class="s4"> </span><span class="s12">Error</span><span class="s7">(</span><span class="s1">"Database not initialized."</span><span class="s7">);</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// Get the user ID for associating the order</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">const</span><span class="s1"> userId </span><span class="s7">=</span><span class="s1"> auth</span><span class="s7">.</span><span class="s1">currentUser</span><span class="s7">?.</span><span class="s1">uid </span><span class="s7">||</span><span class="s1"> </span><span class="s8">'anonymous'</span><span class="s7">;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// Construct the complete order object to be saved</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">const</span><span class="s1"> finalOrderData </span><span class="s7">=</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">...</span><span class="s1">orderData</span><span class="s7">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>userId</span><span class="s7">:</span><span class="s1"> userId</span><span class="s7">,</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                    </span>status</span><span class="s7">:</span><span class="s4"> </span><span class="s8">'new'</span><span class="s4"> </span><span class="s1">// Add an initial status for the order</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">};</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// The collection path where orders will be stored.</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">const</span><span class="s1"> ordersCollectionPath </span><span class="s7">=</span><span class="s1"> </span><span class="s8">`/artifacts/</span><span class="s7">${</span><span class="s1">appId</span><span class="s7">}</span><span class="s8">/public/data/orders`</span><span class="s7">;</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// Add a new document with a generated ID to the 'orders' collection.</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s11">const</span><span class="s1"> docRef </span><span class="s7">=</span><span class="s1"> </span><span class="s11">await</span><span class="s1"> addDoc</span><span class="s7">(</span><span class="s1">collection</span><span class="s7">(</span><span class="s1">db</span><span class="s7">,</span><span class="s1"> ordersCollectionPath</span><span class="s7">),</span><span class="s1"> finalOrderData</span><span class="s7">);</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>console</span><span class="s7">.</span><span class="s1">log</span><span class="s7">(</span><span class="s8">"Order saved with ID: "</span><span class="s7">,</span><span class="s1"> docRef</span><span class="s7">.</span><span class="s1">id</span><span class="s7">);</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>showMessage</span><span class="s7">(</span><span class="s1">'Success!'</span><span class="s7">,</span><span class="s4"> </span><span class="s1">'Your pre-order has been submitted. We will contact you shortly with payment details. Thank you!'</span><span class="s7">,</span><span class="s4"> </span><span class="s1">'start_over'</span><span class="s7">);</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span><span class="s1"> </span><span class="s11">catch</span><span class="s1"> </span><span class="s7">(</span><span class="s1">error</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>console</span><span class="s7">.</span><span class="s4">error</span><span class="s7">(</span><span class="s1">"Error submitting order to Firestore: "</span><span class="s7">,</span><span class="s4"> error</span><span class="s7">);</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span>showMessage</span><span class="s7">(</span><span class="s1">'Submission Failed'</span><span class="s7">,</span><span class="s4"> </span><span class="s1">'There was an error submitting your order. Please check your connection and try again.'</span><span class="s7">,</span><span class="s4"> </span><span class="s1">'continue'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span><span class="s1"> </span><span class="s11">finally</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>submitBtn</span><span class="s7">.</span><span class="s1">disabled </span><span class="s7">=</span><span class="s1"> </span><span class="s11">false</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>submitBtn</span><span class="s7">.</span><span class="s1">textContent </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'Confirm &amp; Submit Pre-Order'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s11">function</span><span class="s1"> showMessage</span><span class="s7">(</span><span class="s1">title</span><span class="s7">,</span><span class="s1"> text</span><span class="s7">,</span><span class="s1"> buttonType</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'message-title'</span><span class="s7">).</span><span class="s1">textContent </span><span class="s7">=</span><span class="s1"> title</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'message-text'</span><span class="s7">).</span><span class="s1">textContent </span><span class="s7">=</span><span class="s1"> text</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">const</span><span class="s1"> button </span><span class="s7">=</span><span class="s1"> document</span><span class="s7">.</span><span class="s1">getElementById</span><span class="s7">(</span><span class="s8">'message-button'</span><span class="s7">);</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">buttonType </span><span class="s7">===</span><span class="s1"> </span><span class="s8">'start_over'</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>button</span><span class="s7">.</span><span class="s1">textContent </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'Start New Order'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>button</span><span class="s7">.</span><span class="s1">onclick </span><span class="s7">=</span><span class="s1"> </span><span class="s7">()</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>location</span><span class="s7">.</span><span class="s1">reload</span><span class="s7">();</span><span class="s1"> </span><span class="s10">// Simple way to reset everything</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">};</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span><span class="s1"> </span><span class="s11">else</span><span class="s1"> </span><span class="s11">if</span><span class="s1"> </span><span class="s7">(</span><span class="s1">buttonType </span><span class="s7">===</span><span class="s1"> </span><span class="s8">'refresh'</span><span class="s7">)</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                 </span>button</span><span class="s7">.</span><span class="s1">textContent </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'Refresh Page'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                 </span>button</span><span class="s7">.</span><span class="s1">onclick </span><span class="s7">=</span><span class="s1"> </span><span class="s7">()</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> location</span><span class="s7">.</span><span class="s1">reload</span><span class="s7">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span><span class="s1"> </span><span class="s11">else</span><span class="s1"> </span><span class="s7">{</span><span class="s1"> </span><span class="s10">// 'continue'</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>button</span><span class="s7">.</span><span class="s1">textContent </span><span class="s7">=</span><span class="s1"> </span><span class="s8">'Close'</span><span class="s7">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>button</span><span class="s7">.</span><span class="s1">onclick </span><span class="s7">=</span><span class="s1"> </span><span class="s7">()</span><span class="s1"> </span><span class="s7">=&gt;</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">MESSAGE_BOX</span><span class="s7">.</span><span class="s1">classList</span><span class="s7">.</span><span class="s1">add</span><span class="s7">(</span><span class="s8">'hidden'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">MESSAGE_BOX</span><span class="s7">.</span><span class="s1">classList</span><span class="s7">.</span><span class="s1">remove</span><span class="s7">(</span><span class="s8">'flex'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">};</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">MESSAGE_BOX</span><span class="s7">.</span><span class="s1">classList</span><span class="s7">.</span><span class="s1">remove</span><span class="s7">(</span><span class="s8">'hidden'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">MESSAGE_BOX</span><span class="s7">.</span><span class="s1">classList</span><span class="s7">.</span><span class="s1">add</span><span class="s7">(</span><span class="s8">'flex'</span><span class="s7">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">}</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- INITIALIZATION ---</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// Expose functions to the global scope so inline onclick handlers can access them</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>window</span><span class="s7">.</span><span class="s1">app </span><span class="s7">=</span><span class="s1"> </span><span class="s7">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>selectMode</span><span class="s7">,</span><span class="s1"> selectDesign</span><span class="s7">,</span><span class="s1"> validateQuantity</span><span class="s7">,</span><span class="s1"> addToOrder</span><span class="s7">,</span><span class="s1"> updateCustomization</span><span class="s7">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>handleCustomFileUpload</span><span class="s7">,</span><span class="s1"> updateAddOns</span><span class="s7">,</span><span class="s1"> selectStep</span><span class="s7">,</span><span class="s1"> goBack</span><span class="s7">,</span><span class="s1"> removeItem</span><span class="s7">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>handleDetailsSubmit</span><span class="s7">,</span><span class="s1"> handleFinalSubmit</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">};</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// Initial render</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>renderModeSelection</span><span class="s7">();</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s1">script</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p1"><span class="s3">&lt;/</span><span class="s1">body</span><span class="s3">&gt;</span></p>
<p class="p1"><span class="s3">&lt;/</span><span class="s1">html</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p6"><span class="s1"></span><br></p>
</body>
</html>
